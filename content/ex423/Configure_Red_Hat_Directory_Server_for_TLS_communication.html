---
title: Configure Red Hat Directory Server for TLS communication
objective: 5
category: EX423
---

In order for this objective to be practiced realistically, you need a few things, including a signed certificate from a CA. I'm sure on the exam that we will be able to just generate a CSR and get a cert back, since there are no objectives for setting up a CA. This is all speculation though, as I have yet to take the test myself and have no idea whats on it. I know that openldap pukes if you try and use a self-signed certificate, without adding "TLS_REQCERT allow" into the conf file. 

So to be thorough, I setup a CA on a seperate EC2 instance. Checkout the guide if you want to go that extra mile while studying. [http://makewhatis.com/2012/04/setting-up-simple-ca-openssl](http://makewhatis.com/2012/04/setting-up-simple-ca-openssl)

### Generate a certificate request and submit CSR to CA

Although this is one of the steps to getting this working, its actually covered in a different objective. Check out the "[Request a certificate from a certificate authority (CA)](http://dev.rhca.co/ex423/Request_a_certificate_from_a_certificate_authority__CA_.html)" page for this step.

### Install the certificates

This is also covered in another objective. Its a prereq to getting this one working, so check that out at: [Install CA-signed server certificate](http://rhca.co/ex423/Install_CA-signed_server_certificate.html)

### Enable TLS on the Directory Admin

Finally, TLS can be enabled. In the Directory Server Console, choose the Configuration tab, and highlight the server name on the left. Choose encryption and check the box for SSL and "Use this cipher family: RSA". You should see your certificate in there now, but you may have to reconnect to see it. At least I did, for some reason it wouldnt show up until I reopened the console. 

Once you are able to see your certificate and choose it, then you can restart your Directory Server. From the Tasks tab choose the "Restart Directory Server" option, and wait for it to restart. 

Now configure your clients to use TLS, and make sure they have the CA certs installed, and you should be connecting over TLS.

### Enable TLS on a client

To enable TLS on the client, all that needs to happen is the cacert be imported, and openldap be told where to find it. 

CA certs go in /etc/openldap/cacerts/. Whatever you name your CA cert, make sure you update the ldap.conf.

    [root@client01 openldap]# vim /etc/openldap/ldap.conf

Add

    BASE    dc=makewhatis,dc=com
    URI ldap://dc03.makewhatis.com
    TLS_CACERT /etc/openldap/cacerts/cacert.crt

* Note: if you dont do tell openldap where to find the cacert, then when trying to do an ldapsearch with TLS enabled, -ZZ, then you will get the following error: *

    [root@client01 openldap]# ldapsearch -ZZ -x
    ldap_start_tls: Connect error (-11)
    additional info: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
